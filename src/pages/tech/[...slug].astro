---
import { getCollection } from "astro:content";
import Layout from "../../components/Layout.astro";
export async function getStaticPaths() {
	const allTech = await getCollection("tech");
	return allTech.map((entry) => ({
		params: { slug: entry.slug },
		props: { entry },
	}));
}

const { entry } = Astro.props;
const { Content, headings } = await entry.render();
const { title, description } = entry.data;
// console.log(headings);
const relatedProjects = await getCollection("projects", ({ data }) => {
	return data.tech.includes(entry.slug);
});
---

<Layout tags={{ title, description }}>
	<main>
		<section class="lg:flex">
			<div class="content lg:max-w-[75%]">
				<h1 class="font-extrabold text-4xl">{title}</h1>
				<p>{description}</p>
			</div>
			<div class="related-projects">
				<h3 class="font-bold border-b-2 border-zinc-600 pb-2 mb-2">
					{`Projects using ${title}`}
				</h3>
				<ul>
					{
						relatedProjects.map((project) => {
							return (
								<li>
									<a
										href={`${Astro.url.origin}/projects/${project.slug}`}
										class="font-medium text-blue-600 dark:text-blue-500 hover:underline;"
									>
										{project.data.title}
									</a>
								</li>
							);
						})
					}
				</ul>
			</div>
		</section>
	</main>
</Layout>
